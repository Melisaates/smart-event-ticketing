nest new <services-names>
nest g res <resource-name> // generate resource inside each service folder
// Choose npm as package manager
cd <services-names>
npm i // install dependencies in each service folder
npm run start:dev // execute this command in each service folder to start the services in development mode and watch for changes

// To run all services together, use Docker Compose
docker-compose -f infrastructure/docker/docker-compose.yml up
// Make sure Docker is installed and running on your machine    
// Access services via their respective ports as defined in the docker-compose file
// For example, if a service is mapped to port 3000, access it via http://localhost:3000

// To stop all services, use:
docker-compose -f infrastructure/docker/docker-compose.yml down

docker exec -it kafka bash
```bash
[appuser@8523122c0bfb ~]$ kafka-topics --create \
> --topic ticket-events \
> --bootstrap-server localhost:9092 \
> partiton 3 \
> partiton 3 \
> replication-factor 1 // Adjust partitions and replication factor as needed . broker numbers 
Created topic ticket-events.
```
//list topics
kafka-topics --list --bootstrap-server localhost:9092 

cd services/ticket-service 
PS C:\Users\melisates\development\smart-event-ticketing\services\ticket-service> npm install @nestjs/microservices 
npm error code ERESOLVE
npm error ERESOLVE unable to resolve dependency tree
npm error
npm error While resolving: ticket-service@0.0.1
npm error Found: @nestjs/common@10.4.20
npm error node_modules/@nestjs/common
npm error   @nestjs/common@"^10.0.0" from the root project
npm error
npm error Could not resolve dependency:
npm error peer @nestjs/common@"^11.0.0" from @nestjs/microservices@11.1.9
npm error node_modules/@nestjs/microservices
npm error   @nestjs/microservices@"*" from the root project
npm error
npm error Fix the upstream dependency conflict, or retry
npm error this command with --force or --legacy-peer-deps
npm error to accept an incorrect (and potentially broken) dependency resolution.
npm error
npm error
npm error For a full report see:
npm error C:\Users\melisates\AppData\Local\npm-cache\_logs\2025-12-11T09_18_07_931Z-eresolve-report.txt
npm error A complete log of this run can be found in: C:\Users\melisates\AppData\Local\npm-cache\_logs\2025-12-11T09_18_07_931Z-debug-0.log
//solution
PS C:\Users\melisates\development\smart-event-ticketing\services\ticket-service> npm install @nestjs/microservices@10  kafkajs 


//call api to buy ticket in powershell
 Invoke-RestMethod -Uri http://localhost:3001/tickets/buy `
>>     -Method POST `
>>     -ContentType "application/json" `
>>     -Body (@{ticketId=22; userId="melisa"} | ConvertTo-Json)

//check logs in kafka container
docker exec -it kafka bash

//install prisma client
npm install prisma --save-dev
npm install @prisma/client
npx prisma init

npx prisma generate// generate prisma client after any change in schema.prisma
//push schema changes to database
npx prisma db push
npx prisma studio   
//create migration
npx prisma migrate dev --name init
//to run prisma studio
npx prisma studio

npm install @types/bcrypt 
npm install @types/jsonwebtoken


npm uninstall @prisma/client prisma
npm install prisma@4.14.0 @prisma/client@4.14.0
npx prisma generate



Invoke-RestMethod -Uri "http://localhost:3000/auth/register" -Method POST -ContentType "application/json" -Body (@{name="melisats"; email="atesmel12@gmail.com"; password="123"} | ConvertTo-Json)


PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> Invoke-RestMethod -Uri "http://localhost:3000/auth/register" -Method POST -ContentType "application/json" -Body (@{name="melisats"; email="atesmel12@gmail.com"; password="123"} | ConvertTo-Json)

PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> Invoke-RestMethod -Uri "http://localhost:3000/auth/login" -Method POST -ContentType "application/json" -Body (@{email="atesmel12@gmail.com"; password="123"} | ConvertTo-Json)                         

accessToken
-----------
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoiYXRlc21lbDEyQGdtYWlsLmNvbSIsImlhdCI6MTc2NTYyNTAxNSwiZXhwIjoxNzY1NjI4NjE1fQ.orfKxi... 


PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> Invoke-RestMethod -Uri "http://localhost:3000/auth/login" -Method POST -ContentType "application/json" -Body (@{email="atesmel12@gmail.com"; password="1253"} | ConvertTo-Json)
Invoke-RestMethod : {"message":"Invalid credentials","error":"Unauthorized","statusCode":401}
At line:1 char:1
+ Invoke-RestMethod -Uri "http://localhost:3000/auth/login" -Method POS ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (System.Net.HttpWebRequest:HttpWebRequest) [Invoke-RestMethod], WebException
    + FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand
PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> 


//get all users
PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> Invoke-RestMethod -Uri "http://localhost:3000/users" -Method GET         

id name     email
-- ----     -----
 1 melisats atesmel12@gmail.com


PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> 

//get one users with id
PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> Invoke-RestMethod -Uri "http://localhost:3000/users/1" -Method GET


id        : 1
name      : melisats
email     : atesmel12@gmail.com
password  : $2b$10$zMGTTuGKOkHs0YspT4e8J.GXSvSaVYSGvR8ce2uq3XJbLNiO1qAza
createdAt : 2025-12-13T11:22:43.023Z
updatedAt : 2025-12-13T11:22:43.023Z
role      : USER



PS C:\Users\melisates\development\smart-event-ticketing\smart-event-ticketing\services\user-service> 

// create topic in kafka container
docker exec -it kafka kafka-topics --bootstrap-server localhost:9092 --create --topic ticket.price.updated partitions 1 replication-factor 1

//list topics
docker exec -it kafka kafka-topics --bootstrap-server localhost:9092 --list

//delete topic
docker exec -it kafka kafka-topics --bootstrap-server localhost:9092 --delete --topic ticket.price.updated